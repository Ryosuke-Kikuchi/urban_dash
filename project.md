デリバリー業務支援アプリ「Urban Dash (仮称)」設計書 (2025年5月22日版)
0. はじめに
本ドキュメントは、デリバリー配達員向け業務支援アプリ「Urban Dash (仮称)」のMVP（Minimum Viable Product）開発に関する設計仕様を定義するものです。本ドキュメントは、開発者が具体的な実装作業に着手するための基礎情報を提供することを目的とします。

本設計書は、依頼者との対話を通じて作成された初期設計案です。実際の開発においては、ユーザビリティテストの結果や技術的な実現可能性に基づき、適宜仕様の調整や詳細化が必要となる場合があります。開発者は、本設計書を基に、依頼者と密接にコミュニケーションを取りながらプロジェクトを推進してください。

1. プロジェクト概要
1.1. アプリ名（仮称）: Urban Dash (アーバン ダッシュ)
1.2. 目的と提供価値: デリバリー配達員の日々の業務効率化、収入管理の容易化、データに基づいた稼働支援、記録を通じたモチベーション維持・向上。
1.3. ターゲットユーザー: フードデリバリーサービスなどで働く全ての配達員。
1.4. 収益化モデル（将来構想）: 月額980円のサブスクリプション（App Store, Google Play経由）。MVP段階では課金機能は実装しません。
2. MVP (Minimum Viable Product) 詳細仕様
2.1. 対象プラットフォーム: Android OS

2.2. バックエンド技術: Firebase (Authentication, Firestore を推奨)

2.3. データモデル詳細 (Firestore)

2.3.1. users コレクション

ドキュメントID: Firebase User UID (string)
フィールド:
email (string, 必須): メールアドレス。
nickname (string, 必須): ニックネーム (2～20文字)。
profileImageUrl (string, 任意): プロフィール画像のURL (MVPでは設定機能なし)。
createdAt (timestamp, 必須, serverTimestamp): アカウント作成日時。
updatedAt (timestamp, 必須, serverTimestamp): アカウント情報更新日時。
2.3.2. workSessions コレクション (1回の勤務ごと)

ドキュメントID: 自動生成ID (string)
フィールド:
userId (string, 必須): usersドキュメントID。要インデックス。
date (string, 必須): 勤務開始日 (YYYY-MM-DD)。
startTime (timestamp, 必須): 勤務開始日時。
endTime (timestamp, 任意): 勤務終了日時 (勤務中はnull)。
status (string, 必須): 勤務状態 ("working", "on_break", "finished")。
totalBreakTimeSeconds (number, 必須, default: 0): 総休憩時間(秒)。
memo (string, 任意): 勤務セッションに関するメモ。
createdAt (timestamp, 必須, serverTimestamp): ドキュメント作成日時。
updatedAt (timestamp, 必須, serverTimestamp): ドキュメント更新日時。
_totalReward (number, default: 0): (集計用) この勤務での総報酬。
_totalCases (number, default: 0): (集計用) この勤務での総案件数。
_totalWorkingDurationSeconds (number, default: 0): (集計用) この勤務での実働時間(秒)。
_totalJizoTimeSeconds (number, default: 0): (集計用) この勤務での総地蔵時間(秒)。
2.3.3. deliveryCases コレクション (1案件ごと)

ドキュメントID: 自動生成ID (string)
フィールド:
workSessionId (string, 必須): workSessionsドキュメントID。要インデックス。
userId (string, 必須): usersドキュメントID。要インデックス。
deliveryService (string, 必須): デリバリーサービス名。
customDeliveryServiceName (string, 任意): deliveryServiceが「その他」の場合のサービス名。
reward (number, 必須): 報酬額(円)。validation: >= 0。
tip (number, 必須, default: 0): チップ額(円)。validation: >= 0。
durationMinutes (number, 任意): 案件所要時間(分)。
orderTime (timestamp, 必須): 案件受注/完了時刻。
memo (string, 任意): 案件メモ。
createdAt (timestamp, 必須, serverTimestamp): ドキュメント作成日時。
2.4. 機能仕様詳細

2.4.1. アカウント機能

ユーザー登録: メール、パスワード、ニックネームを入力。Firebase Authにユーザー作成後、usersコレクションに情報を保存。
ログイン: メール、パスワードで認証。
パスワードリセット: 登録メールアドレスにリセットリンクを送信。
ログアウト: 現在のユーザーセッションを破棄。
2.4.2. 勤務ステータス管理と時間記録機能

ユーザーは「勤務開始」「休憩開始」「休憩終了」「勤務終了」のアクションを実行。
各アクション時にworkSessionsドキュメントのstatus, startTime, endTime, totalBreakTimeSecondsを適切に更新。
アプリ内では現在の勤務状態（未勤務、勤務中、休憩中）と経過時間をリアルタイムに表示。
2.4.3. 案件記録機能

勤務中に案件情報を入力・保存。
必須項目（デリバリーサービス、報酬、案件時刻）、任意項目（チップ、所要時間、メモ）。
保存された案件は現在のworkSessionsに紐づけられる。
案件保存後、ホーム画面の日次サマリーは更新される。
2.4.4. "地蔵時間"（待機時間）の計算ロジック

定義: 勤務中で、かつ配達案件に従事していない時間（休憩時間を除く）。
計算方法:
勤務開始から最初の案件のorderTimeまで。
ある案件の(orderTime + durationMinutes[入力あれば]) から次の案件のorderTimeまで。
最後の案件の(orderTime + durationMinutes[入力あれば]) から勤務終了まで。
勤務終了時に当該セッションの_totalJizoTimeSecondsを計算し保存。
2.4.5. 実質時給の計算ロジック

計算式: 総報酬 / (実働時間(秒) / 3600)
総報酬: 当該workSessionsの_totalReward。
実働時間: (endTimeまたは現在時刻 - startTime) - totalBreakTimeSeconds。
ホーム画面で勤務中にリアルタイム更新表示。
2.4.6. データ表示機能

ホーム画面サマリー: 当日の総報酬、実質時給、完了案件数、総勤務時間、総休憩時間、総地蔵時間を表示。
履歴画面: 過去のworkSessionsを日付降順リスト表示。各セッションの主要情報を表示し、タップで案件詳細を展開。
2.4.7. 基本的な統計データの集計・表示機能

統計画面: 「今日」「今週」「今月」「全期間」で集計期間を選択。
表示項目: 総売上、平均実質時給、総勤務時間、総案件数、平均案件単価、総休憩時間、総地蔵時間/平均地蔵時間。
集計はworkSessionsとdeliveryCasesから都度計算（MVP）。
3. UI/UXデザイン指針
3.1. デザインコンセプト: Urban Dash

キーワード: ミニマル、効率的、クリア、プロフェッショナル、シャープでエッジの効いたダークテーマ。
3.2. カラーパレット:

プライマリー (背景): ブラック (#000000) または ベリーダークグレー (#121212)。
セカンダリー (カード等): ダークグレー (#1E1E1E または #2C2C2C)。
テキスト/アイコン (基本): オフホワイト (#E0E0E0)。
アクセント: 鮮やかな赤 (#FF3B30)。
3.3. タイポグラフィ: Roboto (Android標準) をメインに、ウェイトで見出し・本文を区別。

3.4. 主要画面仕様

3.4.1. 全画面共通事項

ローディング: 中央に円形プログレスインジケータ（アクセントカラー）。
エラー通知: Snackbar/Toast またはダイアログで簡潔なメッセージ表示。
空状態表示: データがない場合は「データがありません」等のメッセージとアイコンを表示。
3.4.2. サインアップ画面

表示: アプリ名、タイトル「アカウント作成」、入力フィールド（ニックネーム, メール, パスワード, パスワード確認）、作成ボタン、ログイン画面へのリンク。
バリデーション: 各フィールドに適切なルールを設定（必須、文字数、形式など）。
3.4.3. ログイン画面

表示: アプリ名、タイトル「ログイン」、入力フィールド（メール, パスワード）、パスワードリセットリンク、ログインボタン、サインアップ画面へのリンク。
3.4.4. パスワードリセット要求画面

表示: タイトル「パスワード再設定」、説明文、入力フィールド（メール）、送信ボタン。
3.4.5. ホーム画面（ダッシュボード）

上部: AppBar（アプリ名、設定アイコン）、ユーザー挨拶、現在の勤務ステータスと経過時間。
中央: 状態に応じたアクションボタン（勤務開始/終了、休憩開始/終了）。
右下: 「案件を追加する」フローティングアクションボタン（勤務中のみ表示）。
下部: 当日サマリーカード（総報酬、実質時給、案件数、総勤務時間、総休憩、総地蔵）。
フッタータブバー: ホーム、履歴、統計、アカウント設定。
3.4.6. 案件入力画面（モーダル）

タイトル「案件記録」。
フォーム: デリバリー会社（ChipGroup/Dropdown、「その他」で自由入力）、報酬（数値）、チップ（数値）、所要時間（分、数値、任意）、案件時刻（DateTimePicker）、メモ（複数行、任意）。
ボタン: 「キャンセル」「保存する」。
3.4.7. 履歴画面

AppBar（タイトル「履歴」）。
workSessionsリスト（日付降順）。各アイテムに日付、勤務時間帯、総報酬、実質時給、案件数を表示。
アイテムタップで当該セッションのdeliveryCases一覧（サービス名、報酬、チップ、時刻）を展開表示。
3.4.8. 統計画面

AppBar（タイトル「統計」）。
期間選択（ChipGroup/Tabs: 今日、今週、今月、全期間）。
選択期間の集計数値表示（総売上、平均実質時給など）。
3.4.9. アカウント設定画面

AppBar（タイトル「アカウント設定」）。
リスト項目: プロフィール（ニックネーム、メール）、パスワード変更、ログアウト、アプリバージョン、(将来用プレースホルダ: ランキング設定、グループ管理、利用規約、プライバシーポリシー)。
3.5. UIコンポーネントスタイルガイド

ボタン: 角丸(4-8dp)。アクセントカラー(#FF3B30)背景＋オフホワイト(#E0E0E0)文字。または、ダーク背景＋アクセントカラー枠線＋アクセントカラー文字。
入力フォーム: 背景セカンダリーカラー。フォーカス時アクセントカラー下線。ラベルはフィールド上部、色はオフホワイト。
カード: 背景セカンダリーカラー、角丸(8dp程度)、ごく薄いドロップシャドウ（または境界線なしで明度差）。
アイコン: Material Design Icons推奨。シンプルライン系。色はアクセントカラーまたはオフホワイト。
タブバー: 背景プライマリーカラー。アクティブタブのアイコンとラベルをアクセントカラーで強調。非アクティブはオフホワイト。
4. 将来的な拡張機能 (概要のみ)
コミュニティ機能（リアルタイムランキング、グループ機能）
GPS連携（走行ログ記録、地図表示）
詳細なデータ可視化（グラフ表示）
高度なデータ活用（単価予測、ヒートマップ）
5. 技術スタック
フロントエンド: Android (React Native または Flutter を推奨)
バックエンド: Firebase (Authentication, Firestore)
推奨UIライブラリ:
React Native: React Native Elements, React Native Paper など
Flutter: 標準のMaterialウィジェット、および pub.dev の各種パッケージ
6. その他特記事項
利用規約・プライバシーポリシー: 将来的なアプリ公開と収益化のため、早期に準備を開始することを推奨します。
テスト: 開発者による単体テスト、結合テストに加え、実際の配達業務をシミュレートしたユーザーシナリオテストを実施してください。
状態管理: フロントエンドの状態管理手法（React Context/Redux/Zustand, Flutter Provider/Riverpod/Bloc等）を初期段階で検討・導入してください。
オフライン対応: Firestoreのオフラインキャッシュ機能を活用し、基本的なデータ閲覧や一時的な記録保存に対応することを検討してください（MVPスコープ外でも可）。
